<!DOCTYPE html>
<html lang="en">
<head><meta name="generator" content="Hexo 3.9.0">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="google-site-verification" content="xBT4GhYoi5qRD5tr338pgPM5OWHHIDR6mNg1a3euekI">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="一直在上路">
    <meta name="keyword" content>
    <link rel="shortcut icon" href="/img/favicon.ico">

    <title>
        
        用python对我和女票的聊天记录生成心形词云 - 浩瀚宇宙的博客 | AaronChen&#39;s Blog
        
    </title>

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/aircloud.css">
    <link rel="stylesheet" href="/css/gitment.css">
    <!--<link rel="stylesheet" href="https://imsun.github.io/gitment/style/default.css">-->
    <link href="//at.alicdn.com/t/font_620856_pl6z7sid89qkt9.css" rel="stylesheet" type="text/css">
    <!-- ga & ba script hoook -->
    <script></script>
</head>

<body>

<div class="site-nav-toggle" id="site-nav-toggle">
    <button>
        <span class="btn-bar"></span>
        <span class="btn-bar"></span>
        <span class="btn-bar"></span>
    </button>
</div>

<div class="index-about">
    <i> 一直在上路 </i>
</div>

<div class="index-container">
    
    <div class="index-left">
        
<div class="nav" id="nav">
    <div class="avatar-name">
        <div class="avatar ">
            <img src="/" />
        </div>
        <div class="name">
            <i>haoyu</i>
        </div>
    </div>
    <div class="contents" id="nav-content">
        <ul>
            <li >
                <a href="/">
                    <i class="iconfont icon-shouye1"></i>
                    <span>主页</span>
                </a>
            </li>
            <li >
                <a href="/tags">
                    <i class="iconfont icon-biaoqian1"></i>
                    <span>标签</span>
                </a>
            </li>
            <li >
                <a href="/archives">
                    <i class="iconfont icon-guidang2"></i>
                    <span>存档</span>
                </a>
            </li>
            <li >
                <a href="/about/">
                    <i class="iconfont icon-guanyu2"></i>
                    <span>关于</span>
                </a>
            </li>
            
            <li>
                <a id="search">
                    <i class="iconfont icon-sousuo1"></i>
                    <span>搜索</span>
                </a>
            </li>
            
        </ul>
    </div>
    
        <div id="toc" class="toc-article">
    <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#前言"><span class="toc-text">前言</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#数据处理"><span class="toc-text">数据处理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#jieba库"><span class="toc-text">jieba库</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#wordcloud库"><span class="toc-text">wordcloud库</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#制作词云图"><span class="toc-text">制作词云图</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#心形词云"><span class="toc-text">心形词云</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#代码"><span class="toc-text">代码</span></a></li></ol>
</div>
    
</div>


<div class="search-field" id="search-field">
    <div class="search-container">
        <div class="search-input">
            <span id="esc-search"> <i class="icon-fanhui iconfont"></i></span>
            <input id="search-input"/>
            <span id="begin-search">搜索</span>
        </div>
        <div class="search-result-container" id="search-result-container">

        </div>
    </div>
</div>

        <div class="index-about-mobile">
            <i> 一直在上路 </i>
        </div>
    </div>
    
    <div class="index-middle">
        <!-- Main Content -->
        


<div class="post-container">
    <div class="post-title">
        用python对我和女票的聊天记录生成心形词云
    </div>

    <div class="post-meta">
        <span class="attr">发布于：<span>2019-07-03 01:05:20</span></span>
        
        <span class="attr">标签：/
        
        <a class="tag" href="/tags/#python" title="python">python</a>
        <span>/</span>
        
        
        </span>
        <span class="attr">访问：<span id="busuanzi_value_page_pv"></span>
</span>
</span>
    </div>
    <div class="post-content ">
        <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>最近看到一些利用python制作词云的教程，突然想到用自己和女友的聊天记录做一个词云，看看平时我俩最常说的都是啥，然后用爱心的形状展示出来，以下是成品:<br><img src="/img/2018-01-19-wordcloud-1.jpg" alt><br>由于导出的记录只有最近两个星期的，再加上这两个星期我女票她都在备考，因此聊天内容并不是特别多，数据可能不是特别有代表性，但至少也能看看了。</p>
<a id="more"></a>

<h2 id="数据处理"><a href="#数据处理" class="headerlink" title="数据处理"></a>数据处理</h2><p>首先我们从QQ中导出txt格式的聊天记录，并在python中打开</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">f = open(<span class="string">'/Users/aaron/文档/My one and only.txt'</span>)</span><br><span class="line">fl = f.readlines()</span><br></pre></td></tr></table></figure>

<p>我们来查看一下数据：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">[&apos;\ufeff消息记录（此消息记录为文本格式，不支持重新导入）\n&apos;,</span><br><span class="line"> &apos;\n&apos;,</span><br><span class="line"> &apos;================================================================\n&apos;,</span><br><span class="line"> &apos;消息分组:My one and only\n&apos;,</span><br><span class="line"> &apos;================================================================\n&apos;,</span><br><span class="line"> &apos;消息对象:xxx\n&apos;,</span><br><span class="line"> &apos;================================================================\n&apos;,</span><br><span class="line"> &apos;\n&apos;,</span><br><span class="line"> &apos;2018-01-12 下午4:00:40 xxx\n&apos;,</span><br><span class="line"> &apos;好丑操\n&apos;,</span><br><span class="line"> &apos;\n&apos;,</span><br><span class="line"> &apos;2018-01-12 下午4:00:49 xxx\n&apos;,</span><br><span class="line"> &apos;好臭\n&apos;,</span><br><span class="line"> &apos;\n&apos;,</span><br><span class="line"> &apos;2018-01-12 下午4:00:50 xxx\n&apos;,</span><br><span class="line"> &apos;好臭\n&apos;,</span><br><span class="line"> &apos;\n&apos;,</span><br><span class="line"> &apos;2018-01-12 下午4:01:27 xxx\n&apos;,</span><br><span class="line"> &apos;我吃牛肉干\n&apos;,</span><br><span class="line"> &apos;\n&apos;,</span><br></pre></td></tr></table></figure>


<p> 可以看出前7行是头信息，下边的数据按照：</p>
<ul>
<li><p>时间，</p>
</li>
<li><p>单句聊天记录，</p>
</li>
<li><p>‘\n’</p>
<p>每三行为一组，于是我们首先删去头信息</p>
</li>
</ul>
<p><code>del fl[:8]</code></p>
<p>接下来我们只需要从下标为1开始，步长为3的聊天记录的数据：</p>
<p><code>fl = fl[1::3]</code></p>
<p>其中 <code>[1::3]</code> 的意思为下标为1开始，步长为3的切片，比如：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>a = [<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a[<span class="number">1</span>::<span class="number">3</span>]</span><br><span class="line">[<span class="number">1</span>, <span class="number">4</span>, <span class="number">7</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a[::<span class="number">3</span>]</span><br><span class="line">[<span class="number">0</span>, <span class="number">3</span>, <span class="number">6</span>, <span class="number">9</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a[:<span class="number">5</span>:<span class="number">2</span>]</span><br><span class="line">[<span class="number">0</span>, <span class="number">2</span>, <span class="number">4</span>]</span><br></pre></td></tr></table></figure>

<p>之后的数据变为一个全部由聊天记录组成的列表：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[&apos;好丑操\n&apos;,</span><br><span class="line"> &apos;好臭\n&apos;,</span><br><span class="line"> &apos;好臭\n&apos;,</span><br><span class="line"> &apos;我吃牛肉干\n&apos;,</span><br><span class="line"> &apos;去去味\n&apos;,</span><br><span class="line"> &apos;。。。。\n&apos;,</span><br><span class="line"> ...</span><br><span class="line"> ]</span><br></pre></td></tr></table></figure>

<p>我们将其组成一个字符串，使用 <code>&#39; &#39;.join(list)</code> 可以将一个列表组合成一个以空格为间隔的字符串：</p>
<p><code>strf = &#39; &#39;.join(fl)</code></p>
<p>观察数据，发现记录中有非常多的杂质，例如 <code>/扯一扯</code>，<code>/糊脸</code>, <code>[放大招]</code>, <code>[表情]</code> 等，我们需要将这些杂质都去掉，于是导入re正则表达式模块：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br></pre></td></tr></table></figure>

<p>两种杂质，一种是以 <code>/</code> 开头，一种是 <code>[xx]</code> 形式，我们用两种正则表达式找出并转换为集合去掉重复元素 </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">list1 = re.findall(r&apos;/.&#123;2,3&#125;&apos;, strf)</span><br><span class="line">list2 = re.findall(r&apos;\[.+?\]&apos;, strf)</span><br><span class="line">set1 = set(list1)</span><br><span class="line">set2 = set(list2)</span><br></pre></td></tr></table></figure>

<p>我们可以看到：</p>
<p><img src="https://ws3.sinaimg.cn/large/006tNc79gy1fnm9fsfrwvj302i05v749.jpg" alt="image"></p>
<p>以及</p>
<p><img src="/img/2018-01-19-wordcloud-2.jpg" alt></p>
<p>然后去掉这些杂质，因为有些出现频率太高会影响最后结果</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> item <span class="keyword">in</span> set1:</span><br><span class="line">    strf = strf.replace(item, <span class="string">''</span>)</span><br><span class="line"><span class="keyword">for</span> item <span class="keyword">in</span> set2:</span><br><span class="line">    strf = strf.replace(item, <span class="string">''</span>)</span><br></pre></td></tr></table></figure>

<p>还有要自己手动去掉两条：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">strf = strf.replace(&apos;请使用最新版本手机QQ查看&apos;, &apos;&apos;)</span><br><span class="line">strf = strf.replace(&apos;请使用最新版手机QQ体验新功能&apos;, &apos;&apos;)</span><br></pre></td></tr></table></figure>

<p>数据干净之后就可以制作词云了。</p>
<h2 id="jieba库"><a href="#jieba库" class="headerlink" title="jieba库"></a>jieba库</h2><p>我们利用 <code>jieba</code> 库对记录进行分词操作，能将一个句子分为单个词语。我们对jieba做一个简单的了解，以下为官方文档中的一部分：</p>
<p><code>jieba.cut</code> 方法接受三个输入参数: 需要分词的字符串；cut_all 参数用来控制是否采用全模式；HMM 参数用来控制是否使用 HMM 模型</p>
<p>代码示例:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># encoding=utf-8</span></span><br><span class="line"><span class="keyword">import</span> jieba</span><br><span class="line"></span><br><span class="line">seg_list = jieba.cut(<span class="string">"我来到北京清华大学"</span>, cut_all=<span class="literal">True</span>)</span><br><span class="line">print(<span class="string">"Full Mode: "</span> + <span class="string">"/ "</span>.join(seg_list))  <span class="comment"># 全模式</span></span><br><span class="line"></span><br><span class="line">seg_list = jieba.cut(<span class="string">"我来到北京清华大学"</span>, cut_all=<span class="literal">False</span>)</span><br><span class="line">print(<span class="string">"Default Mode: "</span> + <span class="string">"/ "</span>.join(seg_list))  <span class="comment"># 精确模式</span></span><br><span class="line"></span><br><span class="line">seg_list = jieba.cut(<span class="string">"他来到了网易杭研大厦"</span>)  <span class="comment"># 默认是精确模式</span></span><br><span class="line">print(<span class="string">", "</span>.join(seg_list))</span><br><span class="line"></span><br><span class="line">seg_list = jieba.cut_for_search(<span class="string">"小明硕士毕业于中国科学院计算所，后在日本京都大学深造"</span>)  <span class="comment"># 搜索引擎模式</span></span><br><span class="line">print(<span class="string">", "</span>.join(seg_list))</span><br></pre></td></tr></table></figure>

<p>输出：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">【全模式】: 我/ 来到/ 北京/ 清华/ 清华大学/ 华大/ 大学</span><br><span class="line"></span><br><span class="line">【精确模式】: 我/ 来到/ 北京/ 清华大学</span><br><span class="line"></span><br><span class="line">【新词识别】：他, 来到, 了, 网易, 杭研, 大厦    (此处，“杭研”并没有在词典中，但是也被Viterbi算法识别出来了)</span><br><span class="line"></span><br><span class="line">【搜索引擎模式】： 小明, 硕士, 毕业, 于, 中国, 科学, 学院, 科学院, 中国科学院, 计算, 计算所, 后, 在, 日本, 京都, 大学, 日本京都大学, 深造</span><br></pre></td></tr></table></figure>

<p>若相对jieba进行更深的了解，可以 <a href="https://github.com/fxsjy/jieba" target="_blank" rel="noopener">点击此处</a></p>
<h2 id="wordcloud库"><a href="#wordcloud库" class="headerlink" title="wordcloud库"></a>wordcloud库</h2><p>我们使用wordcloud包生成词云图，首先了解一下其用法：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">wordcloud</span>.<span class="title">WordCloud</span><span class="params">(font_path=None, width=<span class="number">400</span>, height=<span class="number">200</span>, margin=<span class="number">2</span>, ranks_only=None, prefer_horizontal=<span class="number">0.9</span>,mask=None, scale=<span class="number">1</span>, color_func=None, max_words=<span class="number">200</span>, min_font_size=<span class="number">4</span>, stopwords=None, random_state=None,background_color=<span class="string">'black'</span>, max_font_size=None, font_step=<span class="number">1</span>, mode=<span class="string">'RGB'</span>, relative_scaling=<span class="number">0.5</span>, regexp=None, collocations=True,colormap=None, normalize_plurals=True)</span></span></span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">font_path : string //字体路径，需要展现什么字体就把该字体路径+后缀名写上，如：font_path = &apos;黑体.ttf&apos;</span><br><span class="line"></span><br><span class="line">width : int (default=400) //输出的画布宽度，默认为400像素</span><br><span class="line"></span><br><span class="line">height : int (default=200) //输出的画布高度，默认为200像素</span><br><span class="line"></span><br><span class="line">prefer_horizontal : float (default=0.90) //词语水平方向排版出现的频率，默认 0.9 （所以词语垂直方向排版出现频率为 0.1 ）</span><br><span class="line"></span><br><span class="line">mask : nd-array or None (default=None) //如果参数为空，则使用二维遮罩绘制词云。如果 mask 非空，设置的宽高值将被忽略，遮罩形状被 mask 取代。除全白（#FFFFFF）的部分将不会绘制，其余部分会用于绘制词云。如：bg_pic = imread(&apos;读取一张图片.png&apos;)，背景图片的画布一定要设置为白色（#FFFFFF），然后显示的形状为不是白色的其他颜色。可以用ps工具将自己要显示的形状复制到一个纯白色的画布上再保存，就ok了。</span><br><span class="line"></span><br><span class="line">scale : float (default=1) //按照比例进行放大画布，如设置为1.5，则长和宽都是原来画布的1.5倍。</span><br><span class="line"></span><br><span class="line">min_font_size : int (default=4) //显示的最小的字体大小</span><br><span class="line"></span><br><span class="line">font_step : int (default=1) //字体步长，如果步长大于1，会加快运算但是可能导致结果出现较大的误差。</span><br><span class="line"></span><br><span class="line">max_words : number (default=200) //要显示的词的最大个数</span><br><span class="line"></span><br><span class="line">stopwords : set of strings or None //设置需要屏蔽的词，如果为空，则使用内置的STOPWORDS</span><br><span class="line"></span><br><span class="line">background_color : color value (default=”black”) //背景颜色，如background_color=&apos;white&apos;,背景颜色为白色。</span><br><span class="line"></span><br><span class="line">max_font_size : int or None (default=None) //显示的最大的字体大小</span><br><span class="line"></span><br><span class="line">mode : string (default=”RGB”) //当参数为“RGBA”并且background_color不为空时，背景为透明。</span><br><span class="line"></span><br><span class="line">relative_scaling : float (default=.5) //词频和字体大小的关联性</span><br><span class="line"></span><br><span class="line">color_func : callable, default=None //生成新颜色的函数，如果为空，则使用 self.color_func</span><br><span class="line"></span><br><span class="line">regexp : string or None (optional) //使用正则表达式分隔输入的文本</span><br><span class="line"></span><br><span class="line">collocations : bool, default=True //是否包括两个词的搭配</span><br><span class="line"></span><br><span class="line">colormap : string or matplotlib colormap, default=”viridis” //给每个单词随机分配颜色，若指定color_func，则忽略该方法。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">fit_words(frequencies)  //根据词频生成词云</span><br><span class="line">generate(text)  //根据文本生成词云</span><br><span class="line">generate_from_frequencies(frequencies[, ...])   //根据词频生成词云</span><br><span class="line">generate_from_text(text)    //根据文本生成词云</span><br><span class="line">process_text(text)  //将长文本分词并去除屏蔽词（此处指英语，中文分词还是需要自己用别的库先行实现，使用上面的 fit_words(frequencies) ）</span><br><span class="line">recolor([random_state, color_func, colormap])   //对现有输出重新着色。重新上色会比重新生成整个词云快很多。</span><br><span class="line">to_array()  //转化为 numpy array</span><br><span class="line">to_file(filename)   //输出到文件</span><br></pre></td></tr></table></figure>

<p>了解了这两个包之后，我们开始正式制作词云。</p>
<h2 id="制作词云图"><a href="#制作词云图" class="headerlink" title="制作词云图"></a>制作词云图</h2><p>首先导入所需要的库：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> jieba</span><br><span class="line"><span class="keyword">import</span> wordcloud</span><br></pre></td></tr></table></figure>

<p>然后利用词云进行分词操作，并将生成的列表合并成字符串：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">word_list = jieba.cut(strf, cut_all=<span class="literal">True</span>)</span><br><span class="line">word = <span class="string">' '</span>.join(word_list)</span><br></pre></td></tr></table></figure>

<p>之后利用wordcloud包，注意一定要加上中文字体的路径，因为wordcloud默认是英文字体，并不支持中文，我们只需自己指定字体即可，我这里使用的是宋体，并且指定背景颜色是白色。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wc = wordcloud.WordCloud(font_path=<span class="string">'/Library/Fonts/Songti.ttc'</span>, background_color=<span class="string">'white'</span>).generate(word)</span><br></pre></td></tr></table></figure>

<p>最后使用matplotlib进行绘制：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">plt.imshow(wc)</span><br><span class="line">plt.axis(<span class="string">'off'</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<p>词云图就生成好了：<br><img src="/img/2018-01-19-wordcloud-3.jpg" alt></p>
<h2 id="心形词云"><a href="#心形词云" class="headerlink" title="心形词云"></a>心形词云</h2><p>为了生成心形的词云，我们首先找一张心形的图片：</p>
<p><img src="/img/2018-01-19-wordcloud-4.jpg" alt></p>
<p>然后：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> scipy.misc <span class="keyword">import</span> imread</span><br></pre></td></tr></table></figure>

<p>加上mask参数后再次制作词云：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">pic = imread(<span class="string">'/Users/aaron/Pictures/aixin.png'</span>)</span><br><span class="line">wc = wordcloud.WordCloud(mask=pic, font_path=<span class="string">'/Library/Fonts/Songti.ttc'</span>, width=<span class="number">1000</span>, height=<span class="number">500</span>, background_color=<span class="string">'white'</span>).generate(word)</span><br><span class="line"></span><br><span class="line">plt.imshow(wc)</span><br><span class="line">plt.axis(<span class="string">'off'</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<p>心形词云图诞生！<br><img src="/img/2018-01-19-wordcloud-5.jpg" alt></p>
<p>赶紧学一招然后发给自己的女朋友吧！</p>
<p>或许不是最优方法，欢迎指导。</p>
<h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><p>最后附上全部代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> jieba</span><br><span class="line"><span class="keyword">import</span> wordcloud</span><br><span class="line"><span class="keyword">from</span> scipy.misc <span class="keyword">import</span> imread</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 数据处理</span></span><br><span class="line">f = open(<span class="string">'/Users/aaron/文档/My one and only.txt'</span>)   <span class="comment"># 改成自己的聊天记录文件</span></span><br><span class="line">fl = f.readlines()</span><br><span class="line"><span class="keyword">del</span> fl[:<span class="number">8</span>]</span><br><span class="line">fl = fl[<span class="number">1</span>::<span class="number">3</span>]</span><br><span class="line">strf = <span class="string">' '</span>.join(fl)</span><br><span class="line">list1 = re.findall(<span class="string">r'/.&#123;2,3&#125;'</span>, strf)</span><br><span class="line">list2 = re.findall(<span class="string">r'\[.+?\]'</span>, strf)</span><br><span class="line">set1 = set(list1)</span><br><span class="line">set2 = set(list2)</span><br><span class="line">strf = strf.replace(<span class="string">'请使用最新版本手机QQ查看'</span>, <span class="string">''</span>)</span><br><span class="line">strf = strf.replace(<span class="string">'请使用最新版手机QQ体验新功能'</span>, <span class="string">''</span>)</span><br><span class="line"><span class="keyword">for</span> item <span class="keyword">in</span> set1:</span><br><span class="line">    strf = strf.replace(item, <span class="string">''</span>)</span><br><span class="line"><span class="keyword">for</span> item <span class="keyword">in</span> set2:</span><br><span class="line">    strf = strf.replace(item, <span class="string">''</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 制作词云</span></span><br><span class="line">word_list = jieba.cut(strf, cut_all=<span class="literal">True</span>)</span><br><span class="line">word = <span class="string">' '</span>.join(word_list)</span><br><span class="line">pic = imread(<span class="string">'/Users/aaron/Downloads/aixin.png'</span>)    </span><br><span class="line">wc = wordcloud.WordCloud(mask=pic, font_path=<span class="string">'/Library/Fonts/Songti.ttc'</span>, width=<span class="number">1000</span>, height=<span class="number">500</span>, background_color=<span class="string">'white'</span>).generate(word)</span><br><span class="line"></span><br><span class="line">plt.imshow(wc)</span><br><span class="line">plt.axis(<span class="string">'off'</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>


        
        <br />
        <div id="comment-container">
        </div>
        <div id="disqus_thread"></div>

        <div id="lv-container">
        </div>

    </div>
</div>

    </div>
</div>


<footer class="footer">
    <ul class="list-inline text-center">
        
        
        <li>
            <a target="_blank" href="https://www.zhihu.com/people/haoyuachen">
                            <span class="fa-stack fa-lg">
                                 <i class="iconfont icon-zhihu"></i>
                            </span>
            </a>
        </li>
        

        

        

        
        <li>
            <a target="_blank"  href="https://github.com/aaronchen98">
                            <span class="fa-stack fa-lg">
                                <i class="iconfont icon-github"></i>
                            </span>
            </a>
        </li>
        

        
        <li>
            <a target="_blank"  href="https://www.linkedin.com/in/浩宇-陈-97b3a9151">
                            <span class="fa-stack fa-lg">
                                <i class="iconfont icon-linkedin"></i>
                            </span>
            </a>
        </li>
        

    </ul>
    
    <p>
        <span id="busuanzi_container_site_pv">
            <span id="busuanzi_value_site_pv"></span>PV
        </span>
        <span id="busuanzi_container_site_uv">
            <span id="busuanzi_value_site_uv"></span>UV
        </span>
        Created By <a href="https://hexo.io/">Hexo</a>  Theme <a href="https://github.com/aircloud/hexo-theme-aircloud">AirCloud</a></p>
</footer>




</body>

<script>
    // We expose some of the variables needed by the front end
    window.hexo_search_path = "search.json"
    window.hexo_root = "/"
    window.isPost = true
</script>
<script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script>
<script src="/js/index.js"></script>
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>




</html>
