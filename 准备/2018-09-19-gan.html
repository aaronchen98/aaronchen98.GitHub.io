<!DOCTYPE html>
<html lang>
  <head><meta name="generator" content="Hexo 3.9.0">
    
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,minimum-scale=1,maximum-scale=1">


<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">



  <meta name="description" content="GAN">




  <meta name="keywords" content=",">





  <link rel="alternate" href="/atom.xml" title="浩瀚宇宙·AaronChen">




  <link rel="shortcut icon" type="image/x-icon" href="/img/1.jpg?v=1.1">



<link rel="canonical" href="https://hhyz.me/准备/2018-09-19-gan.html">


<meta name="description" content="概述 论文地址：Generative Adversarial Nets  GAN是Ian Goodfellow提出的使用对抗过程来获得生成模型的新框架。 生成对抗网络主要由两个部分组成，  生成器 \(G\) (Generator) 判别器 \(D\) (discriminator)  生成器G的作用：尽量去拟合 (cover) 真实数据分布，生成以假乱真的图片。它的输入参数是一个随机噪声 \(z">
<meta name="keywords" content="GAN">
<meta property="og:type" content="website">
<meta property="og:title" content="GAN">
<meta property="og:url" content="https://hhyz.me/准备/2018-09-19-gan.html">
<meta property="og:site_name" content="浩瀚宇宙·AaronChen">
<meta property="og:description" content="概述 论文地址：Generative Adversarial Nets  GAN是Ian Goodfellow提出的使用对抗过程来获得生成模型的新框架。 生成对抗网络主要由两个部分组成，  生成器 \(G\) (Generator) 判别器 \(D\) (discriminator)  生成器G的作用：尽量去拟合 (cover) 真实数据分布，生成以假乱真的图片。它的输入参数是一个随机噪声 \(z">
<meta property="og:locale" content="zh">
<meta property="og:updated_time" content="2019-07-02T17:09:45.483Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="GAN">
<meta name="twitter:description" content="概述 论文地址：Generative Adversarial Nets  GAN是Ian Goodfellow提出的使用对抗过程来获得生成模型的新框架。 生成对抗网络主要由两个部分组成，  生成器 \(G\) (Generator) 判别器 \(D\) (discriminator)  生成器G的作用：尽量去拟合 (cover) 真实数据分布，生成以假乱真的图片。它的输入参数是一个随机噪声 \(z">


<link rel="stylesheet" type="text/css" href="/css/style.css?v=1.1">
<link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet">





<script type="text/javascript">
  var themeConfig = {
    fancybox: {
      enable: false
    },
  };
</script>




  





  


    <title> GAN - 浩瀚宇宙·AaronChen </title>
  </head>

  <body>
    <div id="page">
      <header id="masthead"><div class="site-header-inner">
    <h1 class="site-title">
        <a href="/." class="logo">浩瀚宇宙·AaronChen</a>
    </h1>

    <nav id="nav-top">
        
            <ul id="menu-top" class="nav-top-items">
                
                    <li class="menu-item">
                        <a href="http://huangyijiegallery.lofter.com/">
                            
                            
                                Gallery
                            
                        </a>
                    </li>
                
                    <li class="menu-item">
                        <a href="/about">
                            
                            
                                About
                            
                        </a>
                    </li>
                
            </ul>
        
  </nav>
</div>

      </header>
      <div id="content">
        
    <div id="primary">
        <article class="post">
            <header class="post-header">
                <h1 class="post-title">
                    GAN
                </h1>
            </header>
            <div class="post-content">
                <h2 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h2><blockquote>
<p>论文地址：<a href="https://arxiv.org/pdf/1406.2661v1.pdf" target="_blank" rel="noopener">Generative Adversarial Nets</a></p>
</blockquote>
<p>GAN是Ian Goodfellow提出的使用对抗过程来获得生成模型的新框架。</p>
<p>生成对抗网络主要由两个部分组成，</p>
<ul>
<li>生成器 \(G\) (Generator)</li>
<li>判别器 \(D\) (discriminator)</li>
</ul>
<p>生成器G的作用：<br>尽量去拟合 (cover) 真实数据分布，<strong>生成以假乱真的图片</strong>。它的输入参数是一个随机噪声 \(z，G(z)\) 代表其生成的一个样本 (fake data)。</p>
<p>判别器 \(D\) 的作用：<br>判断一张图片是否是“真实的”，<strong>即能判断出一张图片是真实数据(training data)还是生成器 \(G\) 生成的样本 (fake data)</strong>。它的输入参数是 \(x，x\) 代表一张图片， \(D(x)\) 代表 \(x\) 是真实图片的概率。</p>
<p><strong>具体过程：</strong></p>
<ol>
<li><p>对于从训练数据中取样出的真实图片x，判别器D希望D(x)的输出值接近1，即判定训练数据为真实图片。</p>
</li>
<li><p>给定一个随机噪声z，判别器D希望 \(D(G(z))\) 的输出值接近 \(0\) ，即认定生成器G生成的图片是假的；而生成器G希望 \(D(G(z))\) 的输出值接近1，即G希望能够欺骗D，让D将生成器G生成的样本误判为真实图片。这样 G 和 D 就构成了博弈的状态。</p>
</li>
<li><p>在博弈的过程中，生成器G和判别器D都不断的提升自己的能力，最后达到一个平衡的状态。G可以生成足以“以假乱真”的图片G(z)。对于D来说，它难以判定G生成的图片究竟是不是真实的，因此 \(D(G(z)) = 0.5\) 。这样我们的目的就达成了：我们得到了一个生成式的模型G，它可以用来生成真实图片。</p>
</li>
</ol>
<blockquote>
<p>一个很有意思例子：生成器G可以被比作假币制造者团队，试图生产出无法检测出真伪的假币；判别器D可以被比作警察，试图区分出真币和假币。在比拼竞争的过程中，双方都不断提升自己的方法，最终导致假币与真品无法区分。说明我们得到了一个效果非常好的生成器G</p>
</blockquote>
<br>
<div align="center">
![](https://ws3.sinaimg.cn/large/006tNbRwgy1fvf1vsgjyrj30mt09uaaa.jpg)
![](https://ws4.sinaimg.cn/large/006tNbRwgy1fvf33sz4l9j30hs0by74y.jpg)
<center><small><font color="gray">  这里的G网络的输入是一个符合简单分布如高斯分布或者均匀分布的随机噪声  </font></small></center>
</div>
<div align="center">
![](https://ws3.sinaimg.cn/large/006tNbRwgy1fvf4nrc9mfj31980g6wh5.jpg)
<center><small><font color="gray">  黑色的线表示数据x的实际分布，绿色的线表示数据的生成分布，蓝色的线表示生成的数据对应在判别器中的分布效果  </font></small></center>
</div>

<ul>
<li>对于图a，D还刚开始训练，本身分类的能力还很有限，有波动，但是初步区分实际数据和生成数据还是可以的。     </li>
<li>图b，D训练得比较好了，可以很明显的区分出生成数据。     </li>
<li>图c：绿色的线与黑色的线的偏移，蓝色的线下降了，也就是生成数据的概率下降了。那么，由于绿色的线的目标是提升概率，因此就会往蓝色线高的方向移动。那么随着训练的持续，由于G网络的提升，G也反过来影响D的分布。假设固定G网络不动，训练D，那么训练到最优， \(D^*_g(x) = p_{data}(x)/(p_{data}(x)+p_{g}(x))\) 。     </li>
<li>因此，随着 \(p_g(x)\) 趋近于 \(p_{data}(x),D^*_g(x)\) 会趋近于 \(0.5\) ，也就是到图d。而我们的目标就是希望绿色的线能够趋近于黑色的线，也就是让生成的数据分布与实际分布相同。图d符合我们最终想要的训练结果。到这里，G网络和D网络就处于纳什均衡状态，无法再进一步更新了。</li>
</ul>
<p><strong>GAN 模型的目标函数：</strong></p>
<p>$$\min_{G} \max_D V(G,D)=E_{x\sim P_{data}}[logD(x)] + E_{x\sim P_G}[log(1-D(x))]$$</p>
<p>或者我们可以直接理解：<br>G网络的loss是 \(log(1-D(G(z))\) ，<br>而D的loss是 \(-(log(D(x)) + log(1-D(G(z)))\) </p>
<h3 id="怎么训练"><a href="#怎么训练" class="headerlink" title="怎么训练"></a>怎么训练</h3><h4 id="交替训练。"><a href="#交替训练。" class="headerlink" title="交替训练。"></a>交替训练。</h4><ol>
<li>固定G时，训练D；<br>$$\max {E_{x\sim p(r)} log(D(x)) + E_{x\sim p(g)} log(1-D(x)) } $$（公式1）<br>转化成最小形式：<br>$$\min -[{E_{x\sim p(r)} log(D(x)) + E_{x\sim p(g)} log(1-D(x)) } ]$$       </li>
<li>固定D时，训练G。<br>可以设置超参数k, 表示训练k次D，再训练一次G.<br>$$min Loss_G =E_{x\sim P_G}[log(1-D(x))] $$（公式2）</li>
</ol>
<br>
<div align="center">
![](https://ws1.sinaimg.cn/large/006tNbRwgy1fvf3xw32xtj31f20xuah2.jpg)<center><small><font color="gray">    </font></small></center>
</div>

<p>全局最优  \( p_g=p_{data}\)<br> <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=default"></script></p>

            </div>
        </article>
    </div>

        
      <!--noindex-->
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#概述"><span class="nav-text">概述</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#怎么训练"><span class="nav-text">怎么训练</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#交替训练。"><span class="nav-text">交替训练。</span></a></li></ol></li></ol></li></ol></div>
            

          </div>
      <!--/noindex-->
      
      </div>
      <footer id="colophon"><span class="copyright-year">
    
        &copy;
    
        2017 -
    
    2019
    <span class="footer-author">haoyu.</span>
    <span class="power-by">
        Powered by <a class="hexo-link" href="https://hexo.io/">Hexo</a> and <a class="theme-link" href="https://github.com/henryhuang/hexo-theme-polarbearsimple">Polar Bear Simple</a>
    </span>
</span>

      </footer>

      <div class="back-to-top" id="back-to-top">
        <i class="iconfont icon-up"></i>
      </div>
    </div>
    


    




  
    <script type="text/javascript" src="/lib/jquery/jquery-3.1.1.min.js"></script>
  

  

    <script type="text/javascript" src="/js/src/theme.js?v=1.1"></script>
<script type="text/javascript" src="/js/src/bootstrap.js?v=1.1"></script>

  </body>
</html>
